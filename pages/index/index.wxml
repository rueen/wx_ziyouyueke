<!--index.wxml-->
<navBar />
<layout>
  <view class="container">
    <!-- 用户信息卡片 -->
    <view class="user-card">
      <view class="user-header">
        <view class="user-avatar">
          <image src="{{userInfo.avatar}}" class="avatar-img"></image>
        </view>
        <view class="user-info">
          <text class="greeting">{{userRole === 'student' ? 'HELLO STUDENT' : 'HELLO COACH'}}</text>
          <view class="username-row">
            <text class="username">{{userInfo.name}}</text>
            <view class="role-tag">
              <text class="role-text">{{userRole === 'student' ? '学员' : '教练'}}</text>
            </view>
          </view>
        </view>
      </view>

      <view class="stats-row">
        <view class="stat-item" bindtap="onMyCoachOrStudentClick">
          <text class="stat-label">{{userRole === 'student' ? '我的教练' : '我的学员'}}</text>
          <text class="iconfont icon-arrow-r stat-arrow"></text>
        </view>
        
        <view class="stat-item" bindtap="onPendingCoursesClick">
          <text class="stat-label">我的课程</text>
          <text class="iconfont icon-arrow-r stat-arrow"></text>
        </view>
      </view>
    </view>

    <!-- 教练大厅 -->
    <view wx:if="{{userRole === 'student'}}" class="active ad-container" bind:tap="handleOpenAllCoachList">
      <image src="https://ziyouyueke.oss-cn-hangzhou.aliyuncs.com/images/ad1.png" mode="aspectFill" class="ad-image" />
    </view>

    <!-- 活动大厅 -->
    <view class="active ad-container" bind:tap="handleOpenAllGroupCourses">
      <image src="https://ziyouyueke.oss-cn-hangzhou.aliyuncs.com/images/ad1.png" mode="aspectFill" class="ad-image" />
    </view>

    <!-- 我的课表 -->
    <view class="my-schedule">
      <!-- 教练时间安排 -->
      <timeSelector
        wx:if="{{userRole === 'coach'}}"
        id="timeSelector"
        coachId="{{userInfo.id}}"
        mode="view"
        show-booking-details="{{true}}"
      />
      <!-- 学员时间安排 -->
      <studentSchedule
        wx:if="{{userRole === 'student'}}"
        id="studentSchedule"
        studentId="{{userInfo.id}}"
      />
    </view>
    
    <!-- 立即约课按钮 -->
    <view class="book-button-container">
      <!-- <phone-verify id="phoneVerify" bind:verified="onBookCourse" bind:needLogin="onNeedLogin"> -->
        <button class="book-button" bind:tap="onBookCourse">{{userRole === 'student' ? '约教练' : '约学员'}}</button>
      <!-- </phone-verify> -->
    </view>
  </view>
</layout>
