<!--index.wxml-->
<navBar />
<layout>
  <view class="container">
    <!-- ç”¨æˆ·ä¿¡æ¯å¡ç‰‡ -->
    <view class="user-card">
      <view class="user-header">
        <view class="user-avatar">
          <image src="{{userInfo.avatar}}" class="avatar-img"></image>
        </view>
        <view class="user-info">
          <text class="greeting">{{userRole === 'student' ? 'HELLO GYM GIRL' : 'HELLO COACH'}}</text>
          <view class="username-row">
            <text class="username">{{userInfo.name}}</text>
            <view class="role-tag">
              <text class="role-text">{{userRole === 'student' ? 'å­¦å‘˜' : 'æ•™ç»ƒ'}}</text>
            </view>
          </view>
        </view>
      </view>

      <view class="stats-row">
        <view class="stat-item" bindtap="onMyCoachOrStudentClick">
          <text class="stat-label">{{userRole === 'student' ? 'æˆ‘çš„æ•™ç»ƒ' : 'æˆ‘çš„å­¦å‘˜'}}</text>
          <text class="iconfont icon-arrow-r stat-arrow"></text>
        </view>
        
        <view class="stat-item" bindtap="onPendingCoursesClick">
          <text class="stat-label">æˆ‘çš„è¯¾ç¨‹</text>
          <text class="iconfont icon-arrow-r stat-arrow"></text>
        </view>
      </view>
    </view>
    
    <!-- æˆ‘çš„è¯¾è¡¨ -->
    <view class="my-schedule">
      <view class="section-header">
        <text class="section-title">æœ€è¿‘ä¸€æ¬¡è¯¾ç¨‹å®‰æ’</text>
      </view>
      
      <!-- æ—¥å†å¼è¯¾è¡¨ -->
      <view class="calendar-schedule" wx:if="{{calendarData.length > 0}}">
        <view class="day-schedule" wx:for="{{calendarData}}" wx:key="date">
          <!-- æ—¥æœŸæ ‡é¢˜ -->
          <view class="day-header">
            <text class="day-title">{{item.dayTitle}}</text>
            <text class="day-date">{{item.dateStr}}</text>
          </view>
          
          <!-- æ—¶é—´æ®µåˆ—è¡¨ -->
          <view class="time-slots" wx:if="{{item.timeSlots.length > 0}}">
            <view class="time-slot-item {{slot.isBooked ? 'booked' : 'available'}}" 
                  wx:for="{{item.timeSlots}}" wx:for-item="slot" wx:key="id">
              <view class="time-info">
                <text class="time-range">{{slot.startTime}} - {{slot.endTime}}</text>
              </view>
              
              <!-- å·²é¢„çº¦æ˜¾ç¤ºè¯¾ç¨‹ä¿¡æ¯ -->
              <view class="booking-info" wx:if="{{slot.isBooked}}">
                <view class="person-info">
                  <view class="person-avatar">
                    <image src="{{userRole === 'student' ? slot.coachAvatar : slot.studentAvatar}}" class="avatar-img"></image>
                  </view>
                  <view class="person-details">
                    <text class="person-name">{{userRole === 'student' ? slot.coachName : slot.studentName}}</text>
                    <text class="booking-status {{slot.statusClass}}">{{slot.statusText}}</text>
                  </view>
                </view>
                <view class="course-details" wx:if="{{slot.location || slot.remark}}">
                  <text class="course-location" wx:if="{{slot.location}}">ğŸ“ {{slot.location}}</text>
                  <text class="course-remark" wx:if="{{slot.remark}}">ğŸ’¬ {{slot.remark}}</text>
                </view>
              </view>
              
              <!-- æœªé¢„çº¦æ˜¾ç¤ºç©ºçŠ¶æ€ -->
              <view class="empty-booking" wx:else>
                <text class="empty-text">ç©ºé—²æ—¶é—´</text>
              </view>
            </view>
          </view>
          
          <!-- è¯¥æ—¥æ— æ—¶é—´æ®µ -->
          <view class="no-time-slots" wx:else>
            <text class="no-slots-text">ä»Šæ—¥æ— å¯ç”¨æ—¶é—´æ®µ</text>
          </view>
        </view>
      </view>
      
      <!-- ç©ºçŠ¶æ€ -->
      <view class="empty-schedule" wx:else>
        <text class="empty-text">{{userRole === 'student' ? 'æš‚æ— å³å°†å¼€å§‹çš„è¯¾ç¨‹' : 'æš‚æ— å³å°†å¼€å§‹çš„æ—¶é—´å®‰æ’'}}</text>
      </view>
    </view>
    
    <!-- ç«‹å³çº¦è¯¾æŒ‰é’® -->
    <view class="book-button-container">
      <button class="book-button" bindtap="onBookCourse">{{userRole === 'student' ? 'çº¦æ•™ç»ƒ' : 'çº¦å­¦å‘˜'}}</button>
    </view>
  </view>
</layout>
