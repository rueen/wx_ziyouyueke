<!--pages/myDonations/myDonations.wxml-->
<navBar title="我的赞助记录" />
<layout>
  <view class="my-donations-page">
    <!-- 统计信息 -->
    <view class="stats-card" wx:if="{{!isEmpty}}">
      <view class="stats-item">
        <text class="stats-label">累计赞助</text>
        <text class="stats-value">{{total}}</text>
        <text class="stats-unit">笔</text>
      </view>
    </view>

    <!-- 列表 -->
    <view class="donation-list" wx:if="{{list.length > 0}}">
      <view 
        class="donation-item"
        wx:for="{{list}}"
        wx:key="id"
        bindtap="onViewDetail"
        data-id="{{item.id}}">
        <view class="donation-header">
          <view class="donation-status status-{{item.payment_status}}">
            {{item.payment_status === 1 ? '已支付' : item.payment_status === 0 ? '待支付' : item.payment_status === 2 ? '已关闭' : '支付失败'}}
          </view>
          <view class="donation-time">{{item.created_at}}</view>
        </view>
        <view class="donation-content">
          <view class="donation-amount">
            <text class="amount-symbol">¥</text>
            <text class="amount-value">{{item.amount / 100}}</text>
          </view>
          <view class="donation-info">
            <text class="donation-label" wx:if="{{item.is_anonymous}}">
              <text class="iconfont icon-lock"></text> 匿名赞助
            </text>
            <text class="donation-message" wx:if="{{item.message}}">{{item.message}}</text>
          </view>
        </view>
        <view class="donation-footer" wx:if="{{item.paid_at}}">
          <text class="paid-time">支付时间：{{item.paid_at}}</text>
        </view>
      </view>
    </view>

    <!-- 加载状态 -->
    <view class="loading-more" wx:if="{{loading && !isEmpty}}">
      <text class="loading-text">加载中...</text>
    </view>

    <view class="no-more" wx:if="{{!hasMore && !isEmpty && list.length > 0}}">
      <text class="no-more-text">没有更多了</text>
    </view>

    <!-- 空状态 -->
    <empty-state 
      wx:if="{{isEmpty && !loading}}"
      message="暂无赞助记录"
      tip="快去支持一下吧" />
  </view>
</layout>

