<!--pages/coachDetail/coachDetail.wxml-->
<navBar title="教练详情" />
<layout>
  <view class="container">
    <!-- 教练信息 -->
    <view class="coach-header">
      <view class="coach-avatar">
        <image src="{{coachData.coach.avatar_url}}" class="avatar-img"></image>
      </view>
      <view class="coach-info">
        <view class="coach-name">
          <text class="coach-name-text">{{coachData.coach.nickname}}</text>
        </view>
        <text class="coach-phone" wx:if="{{coachData.coach.phone}}">{{coachData.coach.phone}}</text>
        <!-- <view class="remaining-lessons">
          <text class="lessons-label">剩余课时：</text>
          <text class="lessons-count active">{{coachData.remaining_lessons}}节</text>
        </view> -->
      </view>
    </view>

    <!-- 教练介绍 -->
    <view class="intro-section">
      <text class="section-title">教练介绍</text>
      <text class="intro-text">{{coachData.coach.intro}}</text>
    </view>

    <!-- 课时信息 -->
    <view class="intro-section">
      <text class="section-title">课时信息</text>
      <view class="lessons-item" wx:for="{{coachData.category_lessons}}" wx:key="index">
        <text class="categorie-name">{{item.category.name}}</text>
        <view class="remaining-lessons-wrap">
          <text class="expire-date">
            <text wx:if="{{item.expire_date}}">{{item.expire_date}}到期</text>
            <text wx:else>永久有效</text>
          </text>
          <text class="remaining-lessons">{{item.remaining_lessons}}节</text>
        </view>
      </view>
    </view>

    <!-- 卡片信息 -->
    <view class="intro-section" wx:if="{{myCards.length > 0}}">
      <text class="section-title">我的卡片</text>
      <view 
        class="card-item" 
        wx:for="{{myCards}}" 
        wx:key="id"
        bindtap="onViewCardDetail"
        data-card="{{item}}"
      >
        <view class="card-preview" style="background-color: {{item.card_color}};">
          <view class="card-header">
            <view class="card-name">{{item.card_name}}</view>
            <view class="card-status">{{item.card_status_text}}</view>
          </view>
          <view class="card-body">
            <text wx:if="{{item.is_unlimited}}">不限次数</text>
            <text wx:else>剩余 {{item.available_lessons}}/{{item.total_lessons}} 节</text>
            <text class="card-divider">•</text>
            <text>有效期至 {{item.expire_date || '--'}}</text>
          </view>
        </view>
      </view>
    </view>

    <!-- 教练权限 -->
    <view class="intro-section">
      <view class="permission-item">
        <text class="label">该教练发起的课程预约自动确认</text>
        <switch checked="{{auto_confirm_by_coach}}" bindchange="autoConfirmByCoachChange"/>
      </view>
    </view>

    <!-- 活动 -->
    <view class="groupCourse-section" bind:tap="onGroupCourses">
      <text>活动</text>
      <text class="iconfont icon-arrow-r"></text>
    </view>

    <!-- 约课按钮 -->
    <view class="book-button-container">
      <button class="book-button" bindtap="onBookCoach">立即约课</button>
    </view>
  </view>
</layout> 