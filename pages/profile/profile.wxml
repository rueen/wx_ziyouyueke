<!--pages/profile/profile.wxml-->
<ghostNav />
<layout>
  <!-- 用户信息区域 -->
  <view class="user-section" bindtap="onEditProfile">
    <view class="user-info">
      <view class="user-avatar">
        <image src="{{userInfo.avatar}}" class="avatar-img"></image>
      </view>
      <view class="user-details">
        <view class="username-row">
          <text class="username">{{userInfo.nickname}}</text>
          <view class="role-tag">
            <text class="role-text">{{roleNames[userRole]}}</text>
          </view>
        </view>
        <text>
          <text class="user-desc">完善个人资料</text>
          <text class="iconfont icon-arrow-r arrow-icon"></text>
        </text>
      </view>
    </view>
  </view>

  <!-- 公共菜单 -->
  <view class="public-menu-section" bind:tap="openSubscribeMessage">
    <view class="public-menu-item subscribe">
      <text class="iconfont icon-xiaoxidingyue"></text>
      <text class="public-menu-item-text">消息订阅</text>
    </view>
    <view class="public-menu-item coach" bind:tap="handleOpenAllCoachList">
      <text class="iconfont icon-users"></text>
      <text class="public-menu-item-text">教练大厅</text>
    </view>
    <view class="public-menu-item activity" bind:tap="handleOpenAllGroupCourses">
      <text class="iconfont icon-huodong"></text>
      <text class="public-menu-item-text">活动大厅</text>
    </view>
  </view>

  <!-- 功能菜单 -->
  <view class="menu-section">
    <view class="menu-item" bindtap="onMyCourses">
      <view class="menu-content">
        <text class="menu-text">上课记录</text>
      </view>
      <text class="iconfont icon-arrow-r arrow-icon"></text>
    </view>

    <view class="menu-item" bindtap="onGroupCourses">
      <view class="menu-content">
        <text class="menu-text">{{userRole === 'coach' ? '我的活动' : '我报名的活动'}}</text>
        <!-- <view class="new-tag">NEW</view> -->
      </view>
      <text class="iconfont icon-arrow-r arrow-icon"></text>
    </view>

    <view class="menu-item" bindtap="onCoursesCategories" wx:if="{{userRole === 'coach'}}">
      <view class="menu-content">
        <text class="menu-text">我的课程</text>
      </view>
      <text class="iconfont icon-arrow-r arrow-icon"></text>
    </view>
    
    <view class="menu-item" bindtap="onMyCoachesOrStudents">
      <view class="menu-content">
        <text class="menu-text">{{userRole === 'student' ? '我的教练' : '我的学员'}}</text>
      </view>
      <text class="iconfont icon-arrow-r arrow-icon"></text>
    </view>

    <!-- 教练专用：时间模板 -->
    <view class="menu-item" bindtap="onMyTimeTemplate" wx:if="{{userRole === 'coach'}}">
      <view class="menu-content">
        <text class="menu-text">时间模板</text>
      </view>
      <text class="iconfont icon-arrow-r arrow-icon"></text>
    </view>

    <!-- 教练专用：常用地址 -->
    <view class="menu-item" bindtap="onMyAddresses" wx:if="{{userRole === 'coach'}}">
      <view class="menu-content">
        <text class="menu-text">常用地址</text>
      </view>
      <text class="iconfont icon-arrow-r arrow-icon"></text>
    </view>
  </view>
  <!-- 登录/退出登录 -->
  <view class="logout-btn" bindtap="onLogout">
    <text class="logout-text">{{loginType === 'guest' ? '登录' : '退出登录'}}</text>
  </view>
</layout>